import{s as ve,x as we,d as h,y as Ie,z as $e,A as ye,i as A,b as m,l as $,c as k,e as y,m as L,g as V,h as w,j as x,o as be,a as O,f as T,t as D,k as re,r as Ee,n as M,B as F}from"./DjsGgg0N.js";import{S as Ce,i as ke,t as z,a as j,g as W,e as H,d as le,m as ae,c as ie,b as oe}from"./cWIQy_G5.js";import{e as Q}from"./BV4LPSyA.js";import{d as J,w as Ae}from"./CvTewCtI.js";import{C as K}from"./CIAK8BGi.js";import{j as Ne,k as Te,f as ce,l as fe,m as De}from"./DcUeqTlN.js";import{s as Pe}from"./DF6X0GVP.js";import{P as Se}from"./CytU05C8.js";import{T as Ve}from"./BEMotZ7o.js";const G=Ae([]);J(G,r=>r.filter(e=>e.status===K.Signed));J(G,r=>r.filter(e=>e.status===K.Negotiation));J(G,r=>r.filter(e=>e.status===K.Refused));J(G,r=>r.filter(e=>e.status===K.Expired));function rt(r){G.set(r)}function xe(r){let e,t,s='"',l,n,o,v,b='"',u;const C=r[1].default,c=we(C,r,r[0],null);return{c(){e=w("div"),t=w("span"),t.textContent=s,l=x(),n=w("span"),c&&c.c(),o=x(),v=w("span"),v.textContent=b,this.h()},l(d){e=k(d,"DIV",{class:!0});var i=y(e);t=k(i,"SPAN",{"aria-hidden":!0,"data-svelte-h":!0}),L(t)!=="svelte-7wgc03"&&(t.textContent=s),l=V(i),n=k(i,"SPAN",{class:!0});var p=y(n);c&&c.l(p),p.forEach(h),o=V(i),v=k(i,"SPAN",{"aria-hidden":!0,"data-svelte-h":!0}),L(v)!=="svelte-7wgc03"&&(v.textContent=b),i.forEach(h),this.h()},h(){$(t,"aria-hidden","true"),$(n,"class","truncate min-w-0"),$(v,"aria-hidden","true"),$(e,"class","text-xs text-primary-600 italic flex items-center gap-1 min-w-0")},m(d,i){A(d,e,i),m(e,t),m(e,l),m(e,n),c&&c.m(n,null),m(e,o),m(e,v),u=!0},p(d,[i]){c&&c.p&&(!u||i&1)&&Ie(c,C,d,d[0],u?ye(C,d[0],i,null):$e(d[0]),null)},i(d){u||(j(c,d),u=!0)},o(d){z(c,d),u=!1},d(d){d&&h(e),c&&c.d(d)}}}function Re(r,e,t){let{$$slots:s={},$$scope:l}=e;return r.$$set=n=>{"$$scope"in n&&t(0,l=n.$$scope)},[l,s]}class je extends Ce{constructor(e){super(),ke(this,e,Re,xe,ve,{})}}function ue(r,e,t){const s=r.slice();s[9]=e[t].contractId,s[10]=e[t].contract,s[11]=e[t].task;const l=s[10]?s[4](s[10].artistId):void 0;return s[12]=l,s}function de(r,e,t){const s=r.slice();return s[15]=e[t],s}function Be(r){let e,t,s=r[9]+"",l;return{c(){e=w("div"),t=D("Contract "),l=D(s)},l(n){e=k(n,"DIV",{});var o=y(e);t=T(o,"Contract "),l=T(o,s),o.forEach(h)},m(n,o){A(n,e,o),m(e,t),m(e,l)},p(n,o){o&4&&s!==(s=n[9]+"")&&O(l,s)},i:M,o:M,d(n){n&&h(e)}}}function ze(r){let e,t="Loading artist...";return{c(){e=w("div"),e.textContent=t},l(s){e=k(s,"DIV",{"data-svelte-h":!0}),L(e)!=="svelte-1lbvrwx"&&(e.textContent=t)},m(s,l){A(s,e,l)},p:M,i:M,o:M,d(s){s&&h(e)}}}function Oe(r){let e,t=r[12].stageName+"",s,l,n,o,v,b,u=ce(r[11].endTime,r[0],r[3])+"",C,c,d,i;o=new Se({props:{value:fe(r[11].startTime,r[11].endTime,r[3],r[0]),lengthClass:"w-full",thicknessClass:"h-[3px]",useGradient:!0,gradientFromClass:"from-indigo-500",gradientToClass:"to-pink-500",backgroundClass:"bg-gray-700",ariaLabel:`Contract negotiation with ${r[12].stageName} progress`}});let p=Q(r[10].iterations??[]),f=[];for(let a=0;a<p.length;a+=1)f[a]=he(de(r,p,a));const N=a=>z(f[a],1,1,()=>{f[a]=null});return{c(){e=w("div"),s=D(t),l=x(),n=w("div"),oe(o.$$.fragment),v=x(),b=w("div"),C=D(u),c=x(),d=w("div");for(let a=0;a<f.length;a+=1)f[a].c();this.h()},l(a){e=k(a,"DIV",{class:!0});var _=y(e);s=T(_,t),_.forEach(h),l=V(a),n=k(a,"DIV",{class:!0});var E=y(n);ie(o.$$.fragment,E),E.forEach(h),v=V(a),b=k(a,"DIV",{class:!0});var g=y(b);C=T(g,u),g.forEach(h),c=V(a),d=k(a,"DIV",{class:!0});var I=y(d);for(let P=0;P<f.length;P+=1)f[P].l(I);I.forEach(h),this.h()},h(){$(e,"class","font-stretch-condensed text-right"),$(n,"class",""),$(b,"class","font-thin"),$(d,"class","flex")},m(a,_){A(a,e,_),m(e,s),A(a,l,_),A(a,n,_),ae(o,n,null),A(a,v,_),A(a,b,_),m(b,C),A(a,c,_),A(a,d,_);for(let E=0;E<f.length;E+=1)f[E]&&f[E].m(d,null);i=!0},p(a,_){(!i||_&4)&&t!==(t=a[12].stageName+"")&&O(s,t);const E={};if(_&13&&(E.value=fe(a[11].startTime,a[11].endTime,a[3],a[0])),_&4&&(E.ariaLabel=`Contract negotiation with ${a[12].stageName} progress`),o.$set(E),(!i||_&13)&&u!==(u=ce(a[11].endTime,a[0],a[3])+"")&&O(C,u),_&4){p=Q(a[10].iterations??[]);let g;for(g=0;g<p.length;g+=1){const I=de(a,p,g);f[g]?(f[g].p(I,_),j(f[g],1)):(f[g]=he(I),f[g].c(),j(f[g],1),f[g].m(d,null))}for(W(),g=p.length;g<f.length;g+=1)N(g);H()}},i(a){if(!i){j(o.$$.fragment,a);for(let _=0;_<p.length;_+=1)j(f[_]);i=!0}},o(a){z(o.$$.fragment,a),f=f.filter(Boolean);for(let _=0;_<f.length;_+=1)z(f[_]);i=!1},d(a){a&&(h(e),h(l),h(n),h(v),h(b),h(c),h(d)),le(o),be(f,a)}}}function Le(r){let e,t="Awaiting response";return{c(){e=w("span"),e.textContent=t,this.h()},l(s){e=k(s,"SPAN",{class:!0,"data-svelte-h":!0}),L(e)!=="svelte-1s3a9q2"&&(e.textContent=t),this.h()},h(){$(e,"class","text-gray-400")},m(s,l){A(s,e,l)},p:M,d(s){s&&h(e)}}}function qe(r){let e,t=r[15].response.accepted?"Accepted":"Rejected",s;return{c(){e=w("span"),s=D(t),this.h()},l(l){e=k(l,"SPAN",{class:!0});var n=y(e);s=T(n,t),n.forEach(h),this.h()},h(){$(e,"class","text-green-400"),F(e,"text-red-400",!r[15].response.accepted)},m(l,n){A(l,e,n),m(e,s)},p(l,n){n&4&&t!==(t=l[15].response.accepted?"Accepted":"Rejected")&&O(s,t),n&4&&F(e,"text-red-400",!l[15].response.accepted)},d(l){l&&h(e)}}}function Fe(r){let e,t="No offer terms";return{c(){e=w("div"),e.textContent=t,this.h()},l(s){e=k(s,"DIV",{class:!0,"data-svelte-h":!0}),L(e)!=="svelte-52xcj7"&&(e.textContent=t),this.h()},h(){$(e,"class","text-gray-400")},m(s,l){A(s,e,l)},p:M,d(s){s&&h(e)}}}function Me(r){let e,t,s,l="Signing bonus",n,o=r[15].offert.signingBonus+"",v,b,u,C,c,d="Royalty",i,p=r[15].offert.royaltyPercentage+"",f,N,a,_,E,g="Advance",I,P=r[15].offert.advance+"",q,U,X,S=r[15].offert.numberOfReleases&&pe(r);return{c(){e=w("div"),t=w("div"),s=w("span"),s.textContent=l,n=w("span"),v=D(o),b=D("$"),u=x(),C=w("div"),c=w("span"),c.textContent=d,i=w("span"),f=D(p),N=D("%"),a=x(),_=w("div"),E=w("span"),E.textContent=g,I=w("span"),q=D(P),U=D("$"),X=x(),S&&S.c(),this.h()},l(B){e=k(B,"DIV",{class:!0});var R=y(e);t=k(R,"DIV",{class:!0});var Y=y(t);s=k(Y,"SPAN",{"data-svelte-h":!0}),L(s)!=="svelte-1i177h6"&&(s.textContent=l),n=k(Y,"SPAN",{});var Z=y(n);v=T(Z,o),b=T(Z,"$"),Z.forEach(h),Y.forEach(h),u=V(R),C=k(R,"DIV",{class:!0});var ee=y(C);c=k(ee,"SPAN",{"data-svelte-h":!0}),L(c)!=="svelte-1yzhzzi"&&(c.textContent=d),i=k(ee,"SPAN",{});var te=y(i);f=T(te,p),N=T(te,"%"),te.forEach(h),ee.forEach(h),a=V(R),_=k(R,"DIV",{class:!0});var se=y(_);E=k(se,"SPAN",{"data-svelte-h":!0}),L(E)!=="svelte-xm5vvg"&&(E.textContent=g),I=k(se,"SPAN",{});var ne=y(I);q=T(ne,P),U=T(ne,"$"),ne.forEach(h),se.forEach(h),X=V(R),S&&S.l(R),R.forEach(h),this.h()},h(){$(t,"class","flex justify-between gap-2"),$(C,"class","flex justify-between gap-2"),$(_,"class","flex justify-between gap-2"),$(e,"class","flex flex-col gap-0.5 w-full min-w-0")},m(B,R){A(B,e,R),m(e,t),m(t,s),m(t,n),m(n,v),m(n,b),m(e,u),m(e,C),m(C,c),m(C,i),m(i,f),m(i,N),m(e,a),m(e,_),m(_,E),m(_,I),m(I,q),m(I,U),m(e,X),S&&S.m(e,null)},p(B,R){R&4&&o!==(o=B[15].offert.signingBonus+"")&&O(v,o),R&4&&p!==(p=B[15].offert.royaltyPercentage+"")&&O(f,p),R&4&&P!==(P=B[15].offert.advance+"")&&O(q,P),B[15].offert.numberOfReleases?S?S.p(B,R):(S=pe(B),S.c(),S.m(e,null)):S&&(S.d(1),S=null)},d(B){B&&h(e),S&&S.d()}}}function pe(r){let e,t,s="Releases",l,n,o=ge(r[15].offert.numberOfReleases)+"",v;return{c(){e=w("div"),t=w("span"),t.textContent=s,l=x(),n=w("span"),v=D(o),this.h()},l(b){e=k(b,"DIV",{class:!0});var u=y(e);t=k(u,"SPAN",{"data-svelte-h":!0}),L(t)!=="svelte-175mypk"&&(t.textContent=s),l=V(u),n=k(u,"SPAN",{class:!0});var C=y(n);v=T(C,o),C.forEach(h),u.forEach(h),this.h()},h(){$(n,"class","text-right truncate min-w-0"),$(e,"class","flex justify-between gap-2 w-full min-w-0")},m(b,u){A(b,e,u),m(e,t),m(e,l),m(e,n),m(n,v)},p(b,u){u&4&&o!==(o=ge(b[15].offert.numberOfReleases)+"")&&O(v,o)},d(b){b&&h(e)}}}function _e(r){let e,t,s;return t=new je({props:{$$slots:{default:[Ge]},$$scope:{ctx:r}}}),{c(){e=w("div"),oe(t.$$.fragment),this.h()},l(l){e=k(l,"DIV",{class:!0});var n=y(e);ie(t.$$.fragment,n),n.forEach(h),this.h()},h(){$(e,"class","w-full min-w-0")},m(l,n){A(l,e,n),ae(t,e,null),s=!0},p(l,n){const o={};n&262148&&(o.$$scope={dirty:n,ctx:l}),t.$set(o)},i(l){s||(j(t.$$.fragment,l),s=!0)},o(l){z(t.$$.fragment,l),s=!1},d(l){l&&h(e),le(t)}}}function Ge(r){let e=r[15].response.message+"",t;return{c(){t=D(e)},l(s){t=T(s,e)},m(s,l){A(s,t,l)},p(s,l){l&4&&e!==(e=s[15].response.message+"")&&O(t,e)},d(s){s&&h(t)}}}function Qe(r){var E;let e,t,s,l,n=(r[15].iterationNumber??"—")+"",o,v,b,u,C,c;function d(g,I){return g[15].response?qe:Le}let i=d(r),p=i(r);function f(g,I){return g[15].offert?Me:Fe}let N=f(r),a=N(r),_=((E=r[15].response)==null?void 0:E.message)&&_e(r);return{c(){e=w("div"),t=w("div"),s=w("span"),l=D("Iteration "),o=D(n),v=x(),p.c(),b=x(),a.c(),u=x(),_&&_.c(),C=x(),this.h()},l(g){e=k(g,"DIV",{class:!0});var I=y(e);t=k(I,"DIV",{class:!0});var P=y(t);s=k(P,"SPAN",{class:!0});var q=y(s);l=T(q,"Iteration "),o=T(q,n),q.forEach(h),v=V(P),p.l(P),P.forEach(h),b=V(I),a.l(I),u=V(I),_&&_.l(I),I.forEach(h),C=V(g),this.h()},h(){$(s,"class","font-semibold"),$(t,"class","flex text-white justify-between gap-2 w-full mb-1"),$(e,"class","text-xs text-gray-400 italic flex flex-col items-stretch gap-1 min-w-0 w-full max-w-[240px]")},m(g,I){A(g,e,I),m(e,t),m(t,s),m(s,l),m(s,o),m(t,v),p.m(t,null),m(e,b),a.m(e,null),m(e,u),_&&_.m(e,null),A(g,C,I),c=!0},p(g,I){var P;(!c||I&4)&&n!==(n=(g[15].iterationNumber??"—")+"")&&O(o,n),i===(i=d(g))&&p?p.p(g,I):(p.d(1),p=i(g),p&&(p.c(),p.m(t,null))),N===(N=f(g))&&a?a.p(g,I):(a.d(1),a=N(g),a&&(a.c(),a.m(e,u))),(P=g[15].response)!=null&&P.message?_?(_.p(g,I),I&4&&j(_,1)):(_=_e(g),_.c(),j(_,1),_.m(e,null)):_&&(W(),z(_,1,1,()=>{_=null}),H())},i(g){c||(j(_),c=!0)},o(g){z(_),c=!1},d(g){g&&(h(e),h(C)),p.d(),a.d(),_&&_.d()}}}function We(r){let e,t,s,l;return{c(){e=w("div"),t=w("span"),l=x(),this.h()},l(n){e=k(n,"DIV",{slot:!0,class:!0});var o=y(e);t=k(o,"SPAN",{class:!0,title:!0}),y(t).forEach(h),l=V(o),o.forEach(h),this.h()},h(){var n,o;$(t,"class","w-2 h-2 block rounded-full"),$(t,"title",s=r[15].iterationNumber?`Iteration ${r[15].iterationNumber}`:"Pending"),F(t,"bg-green-500",(n=r[15].response)==null?void 0:n.accepted),F(t,"bg-red-500",((o=r[15].response)==null?void 0:o.accepted)===!1),F(t,"bg-gray-600",!r[15].response),$(e,"slot","trigger"),$(e,"class","size-4 flex items-center justify-center")},m(n,o){A(n,e,o),m(e,t),m(e,l)},p(n,o){var v,b;o&4&&s!==(s=n[15].iterationNumber?`Iteration ${n[15].iterationNumber}`:"Pending")&&$(t,"title",s),o&4&&F(t,"bg-green-500",(v=n[15].response)==null?void 0:v.accepted),o&4&&F(t,"bg-red-500",((b=n[15].response)==null?void 0:b.accepted)===!1),o&4&&F(t,"bg-gray-600",!n[15].response)},d(n){n&&h(e)}}}function he(r){let e,t;return e=new Ve({props:{position:"bottom",$$slots:{trigger:[We],default:[Qe]},$$scope:{ctx:r}}}),{c(){oe(e.$$.fragment)},l(s){ie(e.$$.fragment,s)},m(s,l){ae(e,s,l),t=!0},p(s,l){const n={};l&262148&&(n.$$scope={dirty:l,ctx:s}),e.$set(n)},i(s){t||(j(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function me(r){let e,t,s,l,n;const o=[Oe,ze,Be],v=[];function b(u,C){return u[10]&&u[12]?0:u[10]&&u[1]?1:2}return t=b(r),s=v[t]=o[t](r),{c(){e=w("div"),s.c(),l=x(),this.h()},l(u){e=k(u,"DIV",{class:!0});var C=y(e);s.l(C),l=V(C),C.forEach(h),this.h()},h(){$(e,"class","bg-black grid grid-cols-[60px,190px,1fr,1fr,5fr] border-t border-gray-700 px-4 py-1 text-sm gap-4 items-center")},m(u,C){A(u,e,C),v[t].m(e,null),m(e,l),n=!0},p(u,C){let c=t;t=b(u),t===c?v[t].p(u,C):(W(),z(v[c],1,1,()=>{v[c]=null}),H(),s=v[t],s?s.p(u,C):(s=v[t]=o[t](u),s.c()),j(s,1),s.m(e,l))},i(u){n||(j(s),n=!0)},o(u){z(s),n=!1},d(u){u&&h(e),v[t].d()}}}function He(r){let e,t,s,l=r[2].length+"",n,o,v,b,u,C=Q(r[2]),c=[];for(let i=0;i<C.length;i+=1)c[i]=me(ue(r,C,i));const d=i=>z(c[i],1,1,()=>{c[i]=null});return{c(){e=w("article"),t=w("div"),s=D("Currently negotiating "),n=D(l),o=D(" contract(s)"),v=x(),b=w("div");for(let i=0;i<c.length;i+=1)c[i].c();this.h()},l(i){e=k(i,"ARTICLE",{class:!0});var p=y(e);t=k(p,"DIV",{class:!0});var f=y(t);s=T(f,"Currently negotiating "),n=T(f,l),o=T(f," contract(s)"),f.forEach(h),v=V(p),b=k(p,"DIV",{});var N=y(b);for(let a=0;a<c.length;a+=1)c[a].l(N);N.forEach(h),p.forEach(h),this.h()},h(){$(t,"class","px-4 py-2"),$(e,"class","bg-primary-950 border border-gray-700 rounded-lg overflow-hidden select-none")},m(i,p){A(i,e,p),m(e,t),m(t,s),m(t,n),m(t,o),m(e,v),m(e,b);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(b,null);u=!0},p(i,[p]){if((!u||p&4)&&l!==(l=i[2].length+"")&&O(n,l),p&31){C=Q(i[2]);let f;for(f=0;f<C.length;f+=1){const N=ue(i,C,f);c[f]?(c[f].p(N,p),j(c[f],1)):(c[f]=me(N),c[f].c(),j(c[f],1),c[f].m(b,null))}for(W(),f=C.length;f<c.length;f+=1)d(f);H()}},i(i){if(!u){for(let p=0;p<C.length;p+=1)j(c[p]);u=!0}},o(i){c=c.filter(Boolean);for(let p=0;p<c.length;p+=1)z(c[p]);u=!1},d(i){i&&h(e),be(c,i)}}}function ge(r){if(!r)return"—";const e=Object.entries(r).filter(([,t])=>t!==null);return e.length===0?"—":e.map(([t,s])=>`${t}: ${s??0}`).join(", ")}function Je(r,e,t){let s,l,n;re(r,G,d=>t(6,s=d)),re(r,De,d=>t(7,l=d)),re(r,Pe,d=>t(3,n=d));let{contractsTaskResponse:o=[]}=e,{currentTime:v=Date.now()}=e,b=!1,u=[];function C(d){var i;if(d)return(i=l.find(p=>p.artist.id===d))==null?void 0:i.artist}async function c(){if(!b){t(1,b=!0);try{const d=new Set;for(const{contract:i}of u)i!=null&&i.artistId&&!C(i.artistId)&&d.add(i.artistId);if(d.size>0){const i=await Ne(Array.from(d));Te(i,!1)}}catch(d){console.error("Failed to fetch artists for contracts:",d)}finally{t(1,b=!1)}}}return Ee(()=>{c()}),r.$$set=d=>{"contractsTaskResponse"in d&&t(5,o=d.contractsTaskResponse),"currentTime"in d&&t(0,v=d.currentTime)},r.$$.update=()=>{r.$$.dirty&96&&t(2,u=(()=>{const d=new Map,i=s;for(const p of o){if(!p.contractId)continue;const f=i.find(E=>E.id===p.contractId),N=(f==null?void 0:f.id)??p.contractId,a=d.get(N);(!a||new Date(p.endTime).getTime()>new Date(a.task.endTime).getTime())&&d.set(N,{contractId:N,contract:f,task:p})}return Array.from(d.values())})()),r.$$.dirty&6&&u.length>0&&!b&&c()},[v,b,u,n,C,o,s]}class lt extends Ce{constructor(e){super(),ke(this,e,Je,He,ve,{contractsTaskResponse:5,currentTime:0})}}export{lt as C,rt as s};
