var q=s=>{throw TypeError(s)};var P=(s,t,e)=>t.has(s)||q("Cannot "+e);var i=(s,t,e)=>(P(s,t,"read from private field"),e?e.call(s):t.get(s)),l=(s,t,e)=>t.has(s)?q("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),b=(s,t,e,a)=>(P(s,t,"write to private field"),a?a.call(s,e):t.set(s,e),e),m=(s,t,e)=>(P(s,t,"access private method"),e);import{r as L,d as E,w as F}from"./CvTewCtI.js";import{S as J,s as N,n as Q,o as U,p as x,u as B,r as A,t as D,d as v,v as T,w as j,i as _,a as g}from"./DcUeqTlN.js";import{T as R}from"./T19-qTOS.js";import{M as W}from"./DjsGgg0N.js";var o,y,r,u,c,M,K,w,$=(w=class extends J{constructor(t,e){super();l(this,c);l(this,o);l(this,y);l(this,r);l(this,u);b(this,o,t),this.setOptions(e),this.bindMethods(),m(this,c,M).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var a;const e=this.options;this.options=i(this,o).defaultMutationOptions(t),N(this.options,e)||i(this,o).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,r),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&Q(e.mutationKey)!==Q(this.options.mutationKey)?this.reset():((a=i(this,r))==null?void 0:a.state.status)==="pending"&&i(this,r).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=i(this,r))==null||t.removeObserver(this)}onMutationUpdate(t){m(this,c,M).call(this),m(this,c,K).call(this,t)}getCurrentResult(){return i(this,y)}reset(){var t;(t=i(this,r))==null||t.removeObserver(this),b(this,r,void 0),m(this,c,M).call(this),m(this,c,K).call(this)}mutate(t,e){var a;return b(this,u,e),(a=i(this,r))==null||a.removeObserver(this),b(this,r,i(this,o).getMutationCache().build(i(this,o),this.options)),i(this,r).addObserver(this),i(this,r).execute(t)}},o=new WeakMap,y=new WeakMap,r=new WeakMap,u=new WeakMap,c=new WeakSet,M=function(){var e;const t=((e=i(this,r))==null?void 0:e.state)??U();b(this,y,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},K=function(t){x.batch(()=>{var e,a,p,f,k,S,n,d;if(i(this,u)&&this.hasListeners()){const h=i(this,y).variables,O=i(this,y).context,C={client:i(this,o),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((a=(e=i(this,u)).onSuccess)==null||a.call(e,t.data,h,O,C),(f=(p=i(this,u)).onSettled)==null||f.call(p,t.data,null,h,O,C)):(t==null?void 0:t.type)==="error"&&((S=(k=i(this,u)).onError)==null||S.call(k,t.error,h,O,C),(d=(n=i(this,u)).onSettled)==null||d.call(n,void 0,t.error,h,O,C))}this.listeners.forEach(h=>{h(i(this,y))})})},w);function z(s,t){const e=B(),a=A(s)?s:L(s),p=new $(e,W(a));let f;a.subscribe(n=>{f=(d,h)=>{p.mutate(d,h).catch(D)},p.setOptions(n)});const k=L(p.getCurrentResult(),n=>p.subscribe(x.batchCalls(d=>n(d)))),{subscribe:S}=E(k,n=>({...n,mutate:f,mutateAsync:n.mutate}));return{subscribe:S}}async function G(s){return j(`/api/v1/rap-labels/${s}/tasks`)}async function st(s){return v(`/api/v1/tasks/${s}/claim`,{method:"PUT"})}async function et(s){return v("/api/v1/tasks/scouting/predict-cost",{method:"POST",body:JSON.stringify(s)})}async function it(s){return T("/api/v1/tasks/scouting",s)}async function at(s){return v("/api/v1/tasks/sign-artist-contract/predict-cost",{method:"POST",body:JSON.stringify(s)})}async function rt(s){return T("/api/v1/tasks/sign-artist-contract",s)}async function nt(s){return v("/api/v1/tasks/producing-beats/predict-cost",{method:"POST",body:JSON.stringify(s)})}async function ot(s){return T("/api/v1/tasks/producing-beats",s)}async function ut(s){return v("/api/v1/tasks/recording-release/predict-cost",{method:"POST",body:JSON.stringify(s)})}async function ct(s){return T("/api/v1/tasks/recording-release",s)}async function H(s){return T("/api/v1/tasks/publishing-release",s)}const V=F(0);function ht(s){return _({queryKey:s?g.tasks.byLabel(s):["tasks","none"],queryFn:async()=>{const t=await G(s),e=Date.now(),a=t.serverTime.getTime();return V.set(a-e),t.data},enabled:!!s,staleTime:10*1e3})}function yt(s){return{scoutingTasks:s.filter(t=>t.taskType===R.Scouting),contractTasks:s.filter(t=>t.taskType===R.SigningContract),beatProductionTasks:s.filter(t=>t.taskType===R.ProducingBeats),recordingReleaseTasks:s.filter(t=>t.taskType===R.RecordingRelease)}}function pt(s){const t=B();return z({mutationFn:H,onSuccess:e=>{t.setQueryData(g.tasks.byLabel(s),a=>a?[...a,e]:[e]),t.invalidateQueries({queryKey:g.tasks.byLabel(s)}),t.invalidateQueries({queryKey:g.labels.byId(s)}),t.invalidateQueries({queryKey:g.releases.byLabel(s)})}})}export{pt as a,st as b,ht as c,yt as d,ot as e,ut as f,ct as g,et as h,it as i,at as j,rt as k,nt as p,V as s};
